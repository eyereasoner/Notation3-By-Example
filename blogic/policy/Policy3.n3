@prefix : <urn:example:> .
@prefix log: <http://www.w3.org/2000/10/swap/log#> .
@prefix foaf: <http://xmlns.com/foaf/0.1/> .

# Provide a warning when something bad happens
# E.g. exposing an email to a PublicAccess login
(?Login ?RS ?S ?email) log:onNegativeSurface {
    () log:onAccessSurface {
        ?Login a :PublicAccess .
    } .

    () log:onResultSurface ?RS.
    ?RS log:includes {?S foaf:email ?email}.

    () log:onNegativeSurface {
        # We write the warning triples on a warning surface
        () log:onWarningSurface {
            ?S foaf:email ?email {| 
                a log:WARNING; 
                log:warningMessage "You are exposing email addresses as public access!" 
            |}.
        } .
    } .
} {| :name :Policy_3_warning |}.