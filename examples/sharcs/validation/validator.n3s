@prefix : <http://www.example.org/rdf#>.
@prefix log: <http://www.w3.org/2000/10/swap/log#>.
@prefix list: <http://www.w3.org/2000/10/swap/list#> .

# ValidCheck defines the required classes for a login (Required).
# Login has a collection of classes (HasClasses).
# When check if Required is equal to HasClasses.
(?Login ?Class ?HasClasses ?Required ?SCOPE) log:onNegativeSurface {
    ?Login 
        a :Login.

    :ValidCheck :requires ?Required .

    ( ?Class { ?Login a ?Class} ?HasClasses) log:collectAllIn ?SCOPE .

    ?Required list:setEqualTo ?HasClasses .

    () log:onNegativeSurface {
        ?Login :action :AllowService .
    } .
} .

# ValidCheck defines the required classes for a login (Required).
# We check if each required class (Class) is defined for the Login.
# If true, then nothing happens.
# If false, report the missing classes.
(?Login ?Requires ?Class ?SCOPE) log:onNegativeSurface {
    ?Login
        a :Login.

    :ValidCheck :requires ?Requires .
    ?Requires list:member ?Class .

    ?SCOPE log:notIncludes {
        ?Login a ?Class .
    } .

    () log:onNegativeSurface {
        ?Login :action :DenyService .
        ?Login :missing ?Class .
    } .
} .