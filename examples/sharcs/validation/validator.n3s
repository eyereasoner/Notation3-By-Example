@prefix : <http://www.example.org/rdf#>.
@prefix log: <http://www.w3.org/2000/10/swap/log#>.
@prefix list: <http://www.w3.org/2000/10/swap/list#> .

# ValidCheck defines the required classes for a login (Required).
# Login has a collection of classes (HasClasses).
# When check if Required is equal to HasClasses.
(_Login _Class _HasClasses _Required _SCOPE) log:onNegativeSurface {
    _Login 
        a :Login.

    :ValidCheck :requires _Required .

    ( _Class { _Login a _Class} _HasClasses) log:collectAllIn _SCOPE .

    _Required list:setEqualTo _HasClasses .

    () log:onNegativeSurface {
        _Login :action :AllowService .
    } .
} .

# ValidCheck defines the required classes for a login (Required).
# We check if each required class (Class) is defined for the Login.
# If true, then nothing happens.
# If false, report the missing classes.
(_Login _Requires _Class _SCOPE) log:onNegativeSurface {
    _Login
        a :Login.

    :ValidCheck :requires _Requires .
    _Requires list:member _Class .

    _SCOPE log:notIncludes {
        _Login a _Class .
    } .

    () log:onNegativeSurface {
        _Login :action :DenyService .
        _Login :missing _Class .
    } .
} .